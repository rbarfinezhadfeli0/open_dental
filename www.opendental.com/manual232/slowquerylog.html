<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<title>Open Dental Software - Slow Query Log</title>
<link href="resources/manual2.css" rel="stylesheet" type="text/css">
<script src = "resources/manualToc.js"></script>
<script src = "resources/manual.js"></script>
<link rel="icon" type="image/png" href="resources/favicon.png">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

</head>
<body onload="BodyLoaded('slowquerylog','databasemanagementsystems','advancedtopics','technical','manual')">
<nav class="LeftTree">
<div class="TopBarLeft"><p>Table of Contents</p></div>
<div id="Manual"><a href="manual.html">Manual</a></div>
</nav>
<div class="RightMain">
<div class="TopBar">
    <a href="../index.html">
        <div class="Logo">
            <img src="resources/logoWhite160.png" alt="Home" width="158" height="40">
        </div>
    </a>
    <div class="TopBarLinks">
        <div class="TopBarTitle">Manual 
					<select id="SelectVersion" class="TopBarVersionDrop" onchange="location = this.options[this.selectedIndex].value;
						for (var i = 0; i < document.getElementById('SelectVersion').options.length; i++) {
							if (document.getElementById('SelectVersion').options[i].attributes.selected)
								document.getElementById('SelectVersion').selectedIndex=i;
						}"><option value="https://www.opendental.com/manual243/slowquerylog.html" >v24.3 beta</option><option value="https://www.opendental.com/manual/slowquerylog.html" >v24.2</option><option value="https://www.opendental.com/manual241/slowquerylog.html" >v24.1</option><option value="https://www.opendental.com/manual233/slowquerylog.html" >v23.3</option><option value="https://www.opendental.com/manual232/slowquerylog.html"  selected>v23.2</option><option value="https://www.opendental.com/manual231/slowquerylog.html" >v23.1</option><option value="https://www.opendental.com/manual224/slowquerylog.html" >v22.4</option><option value="https://www.opendental.com/manual223/slowquerylog.html" >v22.3</option><option value="https://www.opendental.com/manual222/slowquerylog.html" >v22.2</option><option value="https://www.opendental.com/manual221/slowquerylog.html" >v22.1</option><option value="https://www.opendental.com/manual214/slowquerylog.html" >v21.4</option><option value="https://www.opendental.com/manual213/slowquerylog.html" >v21.3</option><option value="https://www.opendental.com/manual212/slowquerylog.html" >v21.2</option><option value="https://www.opendental.com/manual211/slowquerylog.html" >v21.1</option><option value="https://www.opendental.com/manual205/slowquerylog.html" >v20.5</option><option value="https://www.opendental.com/manual204/slowquerylog.html" >v20.4</option><option value="https://www.opendental.com/manual203/slowquerylog.html" >v20.3</option><option value="https://www.opendental.com/manual202/slowquerylog.html" >v20.2</option><option value="https://www.opendental.com/manual201/slowquerylog.html" >v20.1</option><option value="https://www.opendental.com/manual194/slowquerylog.html" >v19.4</option><option value="https://www.opendental.com/manual193/slowquerylog.html" >v19.3</option><option value="https://www.opendental.com/manual192/slowquerylog.html" >v19.2</option><option value="https://www.opendental.com/manual191/slowquerylog.html" >v19.1</option><option value="https://www.opendental.com/manual184/slowquerylog.html" >v18.4</option><option value="https://www.opendental.com/manual183/slowquerylog.html" >v18.3</option><option value="https://www.opendental.com/manual182/slowquerylog.html" >v18.2</option><option value="https://www.opendental.com/manual181/slowquerylog.html" >v18.1</option><option value="https://www.opendental.com/manual174/slowquerylog.html" >v17.4</option></select>
				</div>        <a href="manual.html"><div class="TopBarHome"><img src="resources/home.gif"/><p>Manual<p></div></a>        <a href="searchmanual.html"><div class="TopBarSearch"><img src="resources/search.gif"/><p>Search<p></div></a>
    </div>       
</div>
<div class="TopBar2"><p>Slow Query Log</p></div>
<div class="GeneralPageContent">
<p>See <a href="databasemanagementsystems.html">Database Management Systems</a>.</p>
<p>The slow query log tool is used to read the slow query log when troubleshooting slowness in Open Dental.</p>
<p>In the Open Dental application folder, double-click the<b>SlowQueryLogTool</b> folder, <b>SlowQueryLogTool.exe</b>.</p>
<img src="images/slowQueryTool.png" width="915" height="463"/><p>If the SlowQueryLogTool folder isn't present, run the Setup.exe on the computer to insert it.</p>
<p>The slow query log tool is used by Open Dental support when <a href="troubleshootingslowness.html">Troubleshooting Slowness</a> issues. Users should contact Open Dental support to determine if the log is needed for their office.</p>
<h2>Slow Query Log Tool</h2>
<p>Use the Slow Query Log Tool to review data from the slow query log. The log must be first be created. See below for details.</p>
<p class="MarginBottomZero">Log Info and Filters: </p>
<ul class="MarginBottomGap">
<li><b>File Path</b>: Enter the location of the slow query log. </li>
<li><b>Log Info</b>: The beginning and end date of the log information.</li>
<li><b>Filter Date and Time</b>: Filter the results of the log by date and office hours.</li>
<li><b>Filter Queries</b>: Filter specific queries by execution time or rows examined.</li>
<li><b>MySQL Version</b>: The MySQL version used by the database.</li>
</ul>
<p class="MarginBottomZero">Grids: </p>
<ul class="MarginBottomGap">
<li><b>Queries</b>: Lists individual queries.</li>
<li><b>Query Groups</b>: Groups similar queries.</li>
</ul>
<p class="MarginBottomZero"><b>Summary</b>:  </p>
<ul class="MarginBottomGap">
<li><b>Grade</b>: An evaluation of how bad the slow query log is. It is based off the average of small to medium sized offices. If the grade is A or B, the slowness is not likely due to the Open Dental database. If the grade is C or lower, the slowness may be a cause of the Open Dental database.</li>
<li><b>Test 1: Rows Examined</b>: This looks at the number of queries that have a low number in the Rows Examined field. This test fails when the percent of queries with Rows Examined less than 5000 rows is over 20 percent.</li>
<li><b>Test 2: Non-Open Dental Queries</b>: This tool detects queries that are not from Open Dental by checking if the queries match the patterns we use when writing queries. If this percentage is high or if the worse queries are third-party, temporarily disable the third-party service to see if slowness improves. This test fails if more than 15% of queries are from a third-party.</li>
<li><b>Test 3: Victim Queries</b>: A query is marked as a victim query when it examines less than 100 rows and takes more than 3 seconds and there is another query that examines over 100,000 rows and takes more than 5 seconds and finishes within 10 seconds after the victim query finished. If a query is a victim query, look for queries around that time to see the root cause of the slowness. This test fails if there are any victim queries.</li>
<li><b>Test 4: User Queries</b>: Queries from the User Query window in Open Dental are sometimes the cause of slowness. A query is counted as a user query if it contains an "@" character or it contains the text "Modified By". This test fails if more than 5% of queries are user queries.</li>
</ul>
<h2>Query Information</h2>
<p>Double-click a query from the Queries grid to view details. </p>
<img src="images/queryInformation.png" width="618" height="391"/><p class="MarginBottomZero">Details in this window are informational only.  </p>
<ul class="MarginBottomGap">
<li>Third Party?: When checked, the query was part of a third-party program. </li>
<li>User Query?: When checked, the query was run from Open Dental (e.g., Query Favorites). </li>
<li>Victim?: When checked, the query was the result of the previous query having problems (e.g., taking too long). </li>
</ul>
<h2>Create the Slow Query Log</h2>
<p>To utilize the tool, first enable to Slow Query Log to gather data.</p>
<p class="MarginBottomZero"></p>
<ol class="MarginBottomGap">
<li>Open the <a href="myini.html">my.ini</a> file.</li>
<li>In the my.ini file, <span class="codeblock">[mysqld]</span> section, add the following 2 lines:<p class="codeblock">slow_query_log=1</p><p class="codeblock">long_query_time=2</p></li>
<li>Save and close the my.ini file.</li>
<li>Restart the MySQL service.</li>
<li>The file is created in the mysql/data folder (named <i>servername-slow.log</i>).</li>
<li>Continue using Open Dental as normal. The log tracks queries run during this usage time.</li>
<li>When enough data is collected, move the file to the mysql/backups folder. If a backups folder does not already exist, create one.</li>
<li>Enter the path of the mysql/backups folder to the File Path field (see above).</li>
<li>Use the Slow Query Log Tool to examine the log for a recurring pattern of slow queries.</li>
</ol>
<p class="MarginBottomZero">When the slow query log is no longer needed:  </p>
<ol class="MarginBottomGap">
<li>In the my.ini file, remove the two lines added above.</li>
<li>Restart the MySQL service.</li>
</ol>
</div>
</div>
</body>
</html>